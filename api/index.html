
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Fang-Cheng Wang">
      
      
      
        <link rel="prev" href="../cli/">
      
      
        <link rel="next" href="../about/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Python API - Crystmatch Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../css/style-crystmatch.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Crystmatch Documentation" class="md-header__button md-logo" aria-label="Crystmatch Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.7 11.29h.01l-9-9C12.5 2.1 12.26 2 12 2s-.5.1-.71.29l-9 9h.01c-.39.39-.39 1.03 0 1.42h-.01l9 9c.21.19.45.29.71.29s.5-.1.71-.29l9-9h-.01c.39-.39.39-1.03 0-1.42M13 8.28V5.41l4.3 4.3zm-2 0L6.7 9.71l4.3-4.3zm1 1.77L17.84 12 12 13.95 6.16 12zm-1 5.67v2.87l-4.3-4.3zm2 0 4.3-1.43-4.3 4.3z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Crystmatch Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Fangcheng-Wang/crystmatch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    crystmatch
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Crystmatch Documentation" class="md-nav__button md-logo" aria-label="Crystmatch Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.7 11.29h.01l-9-9C12.5 2.1 12.26 2 12 2s-.5.1-.71.29l-9 9h.01c-.39.39-.39 1.03 0 1.42h-.01l9 9c.21.19.45.29.71.29s.5-.1.71-.29l9-9h-.01c.39-.39.39-1.03 0-1.42M13 8.28V5.41l4.3 4.3zm-2 0L6.7 9.71l4.3-4.3zm1 1.77L17.84 12 12 13.95 6.16 12zm-1 5.67v2.87l-4.3-4.3zm2 0 4.3-1.43-4.3 4.3z"/></svg>

    </a>
    Crystmatch Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Fangcheng-Wang/crystmatch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    crystmatch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command-line interface
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Python API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Python API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Data structures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.cong_slm" class="md-nav__link">
    <span class="md-ellipsis">
      cong_slm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.enumerate_slm" class="md-nav__link">
    <span class="md-ellipsis">
      enumerate_slm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd_t" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd_t
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd_tp" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd_tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.deform_distance" class="md-nav__link">
    <span class="md-ellipsis">
      deform_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.deviation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      deviation_angle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      multiplicity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.orient_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      orient_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.save_scatter" class="md-nav__link">
    <span class="md-ellipsis">
      save_scatter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.sing_val" class="md-nav__link">
    <span class="md-ellipsis">
      sing_val
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Data structures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.cong_slm" class="md-nav__link">
    <span class="md-ellipsis">
      cong_slm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.enumerate_slm" class="md-nav__link">
    <span class="md-ellipsis">
      enumerate_slm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd_t" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd_t
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.minimize_rmsd_tp" class="md-nav__link">
    <span class="md-ellipsis">
      minimize_rmsd_tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.enumeration.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.deform_distance" class="md-nav__link">
    <span class="md-ellipsis">
      deform_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.deviation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      deviation_angle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      multiplicity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.orient_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      orient_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.save_scatter" class="md-nav__link">
    <span class="md-ellipsis">
      save_scatter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.sing_val" class="md-nav__link">
    <span class="md-ellipsis">
      sing_val
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.analysis.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystmatch.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.create_common_supercell" class="md-nav__link">
    <span class="md-ellipsis">
      create_common_supercell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.get_pure_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      get_pure_rotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_int" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_int
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_list" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.hnf_rational" class="md-nav__link">
    <span class="md-ellipsis">
      hnf_rational
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_arrays_to_pair" class="md-nav__link">
    <span class="md-ellipsis">
      int_arrays_to_pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_fact" class="md-nav__link">
    <span class="md-ellipsis">
      int_fact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.int_vec_inside" class="md-nav__link">
    <span class="md-ellipsis">
      int_vec_inside
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.load_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      load_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.matrix_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_gcd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.matrix_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.niggli_cell" class="md-nav__link">
    <span class="md-ellipsis">
      niggli_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.rmss" class="md-nav__link">
    <span class="md-ellipsis">
      rmss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.save_poscar" class="md-nav__link">
    <span class="md-ellipsis">
      save_poscar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.species_poscar_format" class="md-nav__link">
    <span class="md-ellipsis">
      species_poscar_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.unique_filename" class="md-nav__link">
    <span class="md-ellipsis">
      unique_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crystmatch.utilities.vector_reduce" class="md-nav__link">
    <span class="md-ellipsis">
      vector_reduce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="python-api">Python API</h1>
<h2 id="data-structures">Data structures</h2>
<table>
<thead>
<tr>
<th>Type</th>
<th>Structure</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cryst</code></td>
<td><code>(lattice, species, positions)</code></td>
<td>A crystal structure described by a primitive cell <code>lattice</code>, atomic species <code>species</code>, and fractional coordinates <code>positions</code>. Cell vectors are <strong>rows</strong> of <code>lattice</code>.</td>
</tr>
<tr>
<td><code>slm</code></td>
<td><code>(hA, hB, q)</code></td>
<td>A <a href="https://arxiv.org/abs/2305.05278">sublattice match</a> (SLM) described by an integer-matrix triplet.</td>
</tr>
</tbody>
</table>
<h2 id="functions">Functions</h2>


<div class="doc doc-object doc-module">



<h2 id="crystmatch.enumeration" class="doc doc-heading">
            <code>crystmatch.enumeration</code>


</h2>

    <div class="doc doc-contents first">

        <p>Enumerate SLMs and CSMs.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.cong_slm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cong_slm</span><span class="p">(</span><span class="n">slm</span><span class="p">,</span> <span class="n">gA</span><span class="p">,</span> <span class="n">gB</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The representative SLM of the congruence class of <code>slm</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(hA, hB, q)</code>, representing a SLM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gA</code>
            </td>
            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotation group of the initial crystal structure, whose elements are             integer matrices under fractional coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gB</code>
            </td>
            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotation group of the final crystal structure, whose elements are             integer matrices under fractional coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ss</code></td>            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The representative of the congruence class of <code>slm</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>len_cl</code></td>            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the congruence class of <code>slm</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.create_common_supercell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_common_supercell</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create supercell structures representing <span class="arithmatex">\(\mathcal{A}\)</span> (initial structure)and <span class="arithmatex">\(\sqrt{S^{\text{T}} S}S^{-1}\mathcal{B}\)</span>         (rotation-free final structure). Also return the half-distorted supercell and translation cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\mathcal{A}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\sqrt{S^{\text{T}} S}\mathcal{A}\)</span>, which equals the supercell of <span class="arithmatex">\((S^{\text{T}} S)^{-1/2}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>c_sup_half</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The half-distorted supercell, which equals the supercel of <span class="arithmatex">\((S^{\text{T}} S)^{1/4}\mathcal{A}\)</span> and that of <span class="arithmatex">\((S^{\text{T}} S)^{-1/4}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>f_translate</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The translation cell (fractional coordinates) of the shuffle whose lattice is generated by<code>c_sup_half</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.enumerate_slm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enumerate_slm</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">kappa_max</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">rmss</span><span class="p">,</span> <span class="n">likelihood_ratio</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enumerating all SLMs of multiplicity <code>mu</code> with <code>kappa</code> smaller than <code>kappa_max</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mu</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The multiplicity of SLMs to enumerate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kappa_max</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive threshold value of <code>kappa</code> to determine the range of singular values to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for determining the pure rotation group of the crystal structures. Default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kappa</code>
            </td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that quantifies the strain of a matrix according to its singular values.             Default is <code>rmss</code>, which computes the root-mean-square strain.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="crystmatch.utilities.rmss" href="#crystmatch.utilities.rmss">rmss</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>likelihood_ratio</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expected likelihood ratio of the enumeration being complete and incomplete. Default is 1e2.</p>
              </div>
            </td>
            <td>
                  <code>100.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The level of verbosity. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>slmlist</code></td>            <td>
                  <code>list of slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains triplets of integer matrices like <code>(hA, hB, q)</code>, representing incongruent SLMs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.get_pure_rotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pure_rotation</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find all pure rotations appeared in the space group of <code>cryst</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>3 - tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(lattice, species, positions)</code>, representing the crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>g</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A point group of the first kind, containing all pure rotations appeared in the space group of <code>cryst</code>,             elements of which are integer matrices (under fractional coordinates).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.hnf_int" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decompose square integer matrix <code>m</code> into product of HNF matrix <code>h</code> and unimodular matrix <code>q</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer matrix to decompose, with positive determinant.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column-style Hermite normal form of <code>m</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>m</code> = <code>h @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.hnf_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_list</span><span class="p">(</span><span class="n">det</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enumerate all 3*3 column Hermite normal forms (HNFs) with given determinant.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>det</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The determinant of HNFs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all HNFs with determinant <code>det</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.hnf_rational" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_rational</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The Hermite normal form (HNF) of full-row-rank rational matrix <code>m</code> (not necessarily square or integer).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(M, N) array_like, M &lt;= N</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full-row-rank rational matrix to reduce.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(M, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HNF of <code>m</code> obtained via elementary column operations over integers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.int_arrays_to_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_arrays_to_pair</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the integer arrays representation <code>(slm, p, translations)</code> of a CSM to a pair of crysts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code>(Z, ) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permutaion of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ks</code>
            </td>
            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centered</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to make the centers of <code>crystA_sup</code> and <code>crystB_sup_final</code> coincide. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial structure, whose lattice vectors and atoms are matched to <code>crystB_sup</code> according to the CSM.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final structure, whose lattice vectors and atoms are matched to <code>crystA_sup</code> according to the CSM, with rotation-free orientation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.int_fact" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Factorize positive integer <code>n</code> into products of two integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer to be factorized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>list of 2-tuples of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all <code>(a, b)</code> such that a*b=n.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.int_vec_inside" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_vec_inside</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Integer vectors inside the cell <code>c</code> whose elements are integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matrix whose columns are integer cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>v_int</code></td>            <td>
                  <code>(3, ...) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Its columns are vectors satisfying <code>v = c @ k</code>, where <code>k[0]</code>, <code>k[1]</code>, <code>k[2]</code> <span class="arithmatex">\(\in [0, 1)\)</span>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.load_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">to_primitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load the crystal structure from a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the POSCAR file to be read.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_primitive</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Using the primitive cell instead of the cell given by the POSCAR file. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cryst</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded crystal structure, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.matrix_gcd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_gcd</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a greatest common divisor of rational matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>d</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The greatest common divisor of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.matrix_lcm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_lcm</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a least common multiple of integer matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>m</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The least common multiple of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.minimize_rmsd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimize_rmsd</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">,</span> <span class="n">accurate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimize the RMSD with fixed SLM, variable permutation, overall and lattice-vector translations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Triplets of integer matrices like <code>(hA, hB, q)</code>, representing a SLM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accurate</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the accurate method to minimize the RMSD. If <code>False</code>, the result may be suboptimal. Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rmsd</code></td>            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum atomic displacement (RMSD) between <span class="arithmatex">\((S^{\text{T}} S)^{1/4}\mathcal{A}\)</span> and <span class="arithmatex">\((S^{\text{T}} S)^{-1/4}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>p</code></td>            <td>
                  <code>(Z, ) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permutation of the atoms in <code>pB_sup</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>ks</code></td>            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations (fractional coordinates) of the atoms in <code>pB_sup[:,p]</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>t0</code></td>            <td>
                  <code>(3, ) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The overall translation on <code>pB</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.minimize_rmsd_t" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimize_rmsd_t</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">species</span><span class="p">,</span> <span class="n">pA</span><span class="p">,</span> <span class="n">pB</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimize the RMSD with fixed SLM, overall translation, variable permutation and lattice-vector translations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix whose columns are cell vectors of both crystal structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>species</code>
            </td>
            <td>
                  <code>(N,) array of strs</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array that specifies the type of each ion.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pA</code>
            </td>
            <td>
                  <code>(3, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrices whose columns are fractional coordinates of atoms.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pB</code>
            </td>
            <td>
                  <code>(3, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrices whose columns are fractional coordinates of atoms.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rmsd</code></td>            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimized RMSD.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>p</code></td>            <td>
                  <code>(Z, ) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permutation of the atoms in <code>pB</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>ks</code></td>            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations of the atoms in <code>pB[:,p]</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.minimize_rmsd_tp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimize_rmsd_tp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">pA</span><span class="p">,</span> <span class="n">pB</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimize the RMSD with fixed SLM, overall translation, permutation, and variable lattice-vector translations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix whose columns are cell vectors of both crystal structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pA</code>
            </td>
            <td>
                  <code>(3, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrices whose columns are fractional coordinates of atoms.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pB</code>
            </td>
            <td>
                  <code>(3, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrices whose columns are fractional coordinates of atoms.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rmsd</code></td>            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimized RMSD.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>ks</code></td>            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations (fractional coordinates) of the atoms in <code>pB</code> that minimizes the RMSD.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.niggli_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">niggli_cell</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reduce cell <code>c</code> to its Niggli cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cell to be reduced, whose columns are cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cc</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Niggli cell, with shortest right-handed cell vectors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>cc = c @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.rmss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rmss</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Root-mean-square strain of given singular values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code>(..., 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The singular values of 3*3 matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rms_strain</code></td>            <td>
                  <code>(...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root-mean-square of <code>x - 1</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.save_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">cryst</span><span class="p">,</span> <span class="n">crystname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Save the crystal structure to a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file to save, must not already exist in current directory. If <code>filename = None</code>, a string will be returned instead.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The crystal structure to be saved, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystname</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A system description to write to the comment line of the POSCAR file. If <code>crystname = None</code>, <code>filename</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.species_poscar_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">species_poscar_format</span><span class="p">(</span><span class="n">species</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Examine whether a species array is sorted. If so, convert it to the POSCAR format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>species</code>
            </td>
            <td>
                  <code>(N,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The species array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>species_unique</code></td>            <td>
                  <code>(M,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique species in the order of their first appearance in <code>species</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>species_counts</code></td>            <td>
                  <code>(M,) array of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of occurrences of each unique species in <code>species</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.unique_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_filename</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a unique filename by appending a number to the end of the given filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A message to print before the filename.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_filename</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified filename with a unique number appended.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.enumeration.vector_reduce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_reduce</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">divisors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimizing the norm of <code>v</code> by adding and subtracting columns of <code>divisors</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector to be reduced.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>divisors</code>
            </td>
            <td>
                  <code>(N, ...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vectors used to translate <code>v</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>vv</code></td>            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reduced <code>v</code> with minimum Euclidean norm.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="crystmatch.analysis" class="doc doc-heading">
            <code>crystmatch.analysis</code>


</h2>

    <div class="doc doc-contents first">

        <p>Analyze and visualize CSMs.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.create_common_supercell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_common_supercell</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create supercell structures representing <span class="arithmatex">\(\mathcal{A}\)</span> (initial structure)and <span class="arithmatex">\(\sqrt{S^{\text{T}} S}S^{-1}\mathcal{B}\)</span>         (rotation-free final structure). Also return the half-distorted supercell and translation cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\mathcal{A}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\sqrt{S^{\text{T}} S}\mathcal{A}\)</span>, which equals the supercell of <span class="arithmatex">\((S^{\text{T}} S)^{-1/2}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>c_sup_half</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The half-distorted supercell, which equals the supercel of <span class="arithmatex">\((S^{\text{T}} S)^{1/4}\mathcal{A}\)</span> and that of <span class="arithmatex">\((S^{\text{T}} S)^{-1/4}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>f_translate</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The translation cell (fractional coordinates) of the shuffle whose lattice is generated by<code>c_sup_half</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.deform_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">deform_distance</span><span class="p">(</span><span class="n">slmlist</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The Frobenius distance between deformation gradients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>slmlist</code>
            </td>
            <td>
                  <code>list of slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of SLMs, each represented by a triplet of integer matrices like <code>(hA, hB, q)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s0</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(hA, hB, q)</code>, representing a SLM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(lattice, species, positions)</code>, representing the crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(lattice, species, positions)</code>, representing the crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dlist</code></td>            <td>
                  <code>(...,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains Frobenius distances from <code>slmlist</code> to <code>s0</code>, where equivalent SLMs coincide.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.deviation_angle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">deviation_angle</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slmlist</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">uspfix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate how much each SLM in <code>slmlist</code> differ from a given orientation relationship.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slmlist</code>
            </td>
            <td>
                  <code>list of slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of SLMs, each represented by a triplet of integer matrices like <code>(hA, hB, q)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>r</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rotation matrix representing the given orientation relationship.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>uspfix</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fix the uniformed scaled plane. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>anglelist</code></td>            <td>
                  <code>(...,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains rotation angles that measure the difference of each SLM and the given orientation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.get_pure_rotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pure_rotation</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find all pure rotations appeared in the space group of <code>cryst</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>3 - tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(lattice, species, positions)</code>, representing the crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>g</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A point group of the first kind, containing all pure rotations appeared in the space group of <code>cryst</code>,             elements of which are integer matrices (under fractional coordinates).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.hnf_int" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decompose square integer matrix <code>m</code> into product of HNF matrix <code>h</code> and unimodular matrix <code>q</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer matrix to decompose, with positive determinant.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column-style Hermite normal form of <code>m</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>m</code> = <code>h @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.hnf_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_list</span><span class="p">(</span><span class="n">det</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enumerate all 3*3 column Hermite normal forms (HNFs) with given determinant.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>det</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The determinant of HNFs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all HNFs with determinant <code>det</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.hnf_rational" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_rational</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The Hermite normal form (HNF) of full-row-rank rational matrix <code>m</code> (not necessarily square or integer).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(M, N) array_like, M &lt;= N</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full-row-rank rational matrix to reduce.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(M, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HNF of <code>m</code> obtained via elementary column operations over integers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.int_arrays_to_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_arrays_to_pair</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the integer arrays representation <code>(slm, p, translations)</code> of a CSM to a pair of crysts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code>(Z, ) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permutaion of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ks</code>
            </td>
            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centered</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to make the centers of <code>crystA_sup</code> and <code>crystB_sup_final</code> coincide. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial structure, whose lattice vectors and atoms are matched to <code>crystB_sup</code> according to the CSM.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final structure, whose lattice vectors and atoms are matched to <code>crystA_sup</code> according to the CSM, with rotation-free orientation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.int_fact" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Factorize positive integer <code>n</code> into products of two integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer to be factorized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>list of 2-tuples of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all <code>(a, b)</code> such that a*b=n.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.int_vec_inside" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_vec_inside</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Integer vectors inside the cell <code>c</code> whose elements are integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matrix whose columns are integer cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>v_int</code></td>            <td>
                  <code>(3, ...) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Its columns are vectors satisfying <code>v = c @ k</code>, where <code>k[0]</code>, <code>k[1]</code>, <code>k[2]</code> <span class="arithmatex">\(\in [0, 1)\)</span>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.load_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">to_primitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load the crystal structure from a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the POSCAR file to be read.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_primitive</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Using the primitive cell instead of the cell given by the POSCAR file. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cryst</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded crystal structure, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.matrix_gcd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_gcd</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a greatest common divisor of rational matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>d</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The greatest common divisor of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.matrix_lcm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_lcm</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a least common multiple of integer matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>m</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The least common multiple of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.multiplicity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multiplicity</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slmlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return multiplicities of elements in <code>slmlist</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slmlist</code>
            </td>
            <td>
                  <code>list of slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of SLMs, each represented by a triplet of integer matrices like <code>(hA, hB, q)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>mu</code></td>            <td>
                  <code>int or (...,) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplicities of each SLM in <code>slmlist</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.niggli_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">niggli_cell</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reduce cell <code>c</code> to its Niggli cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cell to be reduced, whose columns are cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cc</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Niggli cell, with shortest right-handed cell vectors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>cc = c @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.orient_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">orient_matrix</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span> <span class="n">vf</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">wf</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rotation matrix <code>r</code> such that <code>r @ vi</code> || <code>vf</code> and <code>r @ wi</code> || <code>wf</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vi</code>
            </td>
            <td>
                  <code>(3,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vectors (cartesian coordinates) that satisfy <code>r @ vi</code> || <code>vf</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vf</code>
            </td>
            <td>
                  <code>(3,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vectors (cartesian coordinates) that satisfy <code>r @ vi</code> || <code>vf</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wi</code>
            </td>
            <td>
                  <code>(3,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vectors (cartesian coordinates) that satisfy <code>r @ wi</code> || <code>wf</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wf</code>
            </td>
            <td>
                  <code>(3,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vectors (cartesian coordinates) that satisfy <code>r @ wi</code> || <code>wf</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>r</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rotation matrix representing the given orientation relationship.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.rmss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rmss</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Root-mean-square strain of given singular values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code>(..., 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The singular values of 3*3 matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rms_strain</code></td>            <td>
                  <code>(...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root-mean-square of <code>x - 1</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.save_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">cryst</span><span class="p">,</span> <span class="n">crystname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Save the crystal structure to a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file to save, must not already exist in current directory. If <code>filename = None</code>, a string will be returned instead.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The crystal structure to be saved, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystname</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A system description to write to the comment line of the POSCAR file. If <code>crystname = None</code>, <code>filename</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.save_scatter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_scatter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">rmsslist</span><span class="p">,</span> <span class="n">rmsdlist</span><span class="p">,</span> <span class="n">colorlist</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">),</span> <span class="n">cbarlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scatter plot of the CSMs with colorbar.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the saved plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rmsslist</code>
            </td>
            <td>
                  <code>(N,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root-mean-square strain of each CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rmsdlist</code>
            </td>
            <td>
                  <code>(N,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root-mean-square distance of each CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colorlist</code>
            </td>
            <td>
                  <code>(N,) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Some quantity of each CSM, which is to be colored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cmap</code>
            </td>
            <td>
                  <code>`matplotlib.colors.Colormap`</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The colormap to use. Default is <code>plt.cm.get_cmap('viridis')</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="matplotlib.pyplot.cm.get_cmap">get_cmap</span>(&#39;viridis&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbarlabel</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the colorbar. Default is None, in which case the filename is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.sing_val" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sing_val</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slmlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return singular values of elements in <code>slmlist</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slmlist</code>
            </td>
            <td>
                  <code>list of slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of SLMs, each represented by a triplet of integer matrices like <code>(hA, hB, q)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>sv</code></td>            <td>
                  <code>(..., 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains singular values of each SLM in <code>slmlist</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.species_poscar_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">species_poscar_format</span><span class="p">(</span><span class="n">species</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Examine whether a species array is sorted. If so, convert it to the POSCAR format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>species</code>
            </td>
            <td>
                  <code>(N,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The species array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>species_unique</code></td>            <td>
                  <code>(M,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique species in the order of their first appearance in <code>species</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>species_counts</code></td>            <td>
                  <code>(M,) array of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of occurrences of each unique species in <code>species</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.unique_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_filename</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a unique filename by appending a number to the end of the given filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A message to print before the filename.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_filename</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified filename with a unique number appended.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.analysis.vector_reduce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_reduce</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">divisors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimizing the norm of <code>v</code> by adding and subtracting columns of <code>divisors</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector to be reduced.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>divisors</code>
            </td>
            <td>
                  <code>(N, ...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vectors used to translate <code>v</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>vv</code></td>            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reduced <code>v</code> with minimum Euclidean norm.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="crystmatch.utilities" class="doc doc-heading">
            <code>crystmatch.utilities</code>


</h2>

    <div class="doc doc-contents first">

        <p>Load/save crystal structures and CSMs from/to files.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.create_common_supercell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_common_supercell</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create supercell structures representing <span class="arithmatex">\(\mathcal{A}\)</span> (initial structure)and <span class="arithmatex">\(\sqrt{S^{\text{T}} S}S^{-1}\mathcal{B}\)</span>         (rotation-free final structure). Also return the half-distorted supercell and translation cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\mathcal{A}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The supercell of <span class="arithmatex">\(\sqrt{S^{\text{T}} S}\mathcal{A}\)</span>, which equals the supercell of <span class="arithmatex">\((S^{\text{T}} S)^{-1/2}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>c_sup_half</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The half-distorted supercell, which equals the supercel of <span class="arithmatex">\((S^{\text{T}} S)^{1/4}\mathcal{A}\)</span> and that of <span class="arithmatex">\((S^{\text{T}} S)^{-1/4}\mathcal{B}\)</span>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>f_translate</code></td>            <td>
                  <code>(3, 3) array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The translation cell (fractional coordinates) of the shuffle whose lattice is generated by<code>c_sup_half</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.get_pure_rotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pure_rotation</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find all pure rotations appeared in the space group of <code>cryst</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>3 - tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(lattice, species, positions)</code>, representing the crystal structure, usually obtained by <code>load_poscar</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>g</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A point group of the first kind, containing all pure rotations appeared in the space group of <code>cryst</code>,             elements of which are integer matrices (under fractional coordinates).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.hnf_int" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decompose square integer matrix <code>m</code> into product of HNF matrix <code>h</code> and unimodular matrix <code>q</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer matrix to decompose, with positive determinant.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column-style Hermite normal form of <code>m</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(N, N) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>m</code> = <code>h @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.hnf_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_list</span><span class="p">(</span><span class="n">det</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enumerate all 3*3 column Hermite normal forms (HNFs) with given determinant.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>det</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The determinant of HNFs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>(..., 3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all HNFs with determinant <code>det</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.hnf_rational" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hnf_rational</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The Hermite normal form (HNF) of full-row-rank rational matrix <code>m</code> (not necessarily square or integer).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>(M, N) array_like, M &lt;= N</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full-row-rank rational matrix to reduce.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>h</code></td>            <td>
                  <code>(M, N) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HNF of <code>m</code> obtained via elementary column operations over integers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.int_arrays_to_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_arrays_to_pair</span><span class="p">(</span><span class="n">crystA</span><span class="p">,</span> <span class="n">crystB</span><span class="p">,</span> <span class="n">slm</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the integer arrays representation <code>(slm, p, translations)</code> of a CSM to a pair of crysts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crystA</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystB</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial and final structures.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slm</code>
            </td>
            <td>
                  <code>slm</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM of the CSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code>(Z, ) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permutaion of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ks</code>
            </td>
            <td>
                  <code>(3, Z) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lattice-vector translations of the shuffle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centered</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to make the centers of <code>crystA_sup</code> and <code>crystB_sup_final</code> coincide. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>crystA_sup</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial structure, whose lattice vectors and atoms are matched to <code>crystB_sup</code> according to the CSM.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>crystB_sup_final</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final structure, whose lattice vectors and atoms are matched to <code>crystA_sup</code> according to the CSM, with rotation-free orientation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.int_fact" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Factorize positive integer <code>n</code> into products of two integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer to be factorized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>l</code></td>            <td>
                  <code>list of 2-tuples of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains all <code>(a, b)</code> such that a*b=n.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.int_vec_inside" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_vec_inside</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Integer vectors inside the cell <code>c</code> whose elements are integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matrix whose columns are integer cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>v_int</code></td>            <td>
                  <code>(3, ...) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Its columns are vectors satisfying <code>v = c @ k</code>, where <code>k[0]</code>, <code>k[1]</code>, <code>k[2]</code> <span class="arithmatex">\(\in [0, 1)\)</span>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.load_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">to_primitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load the crystal structure from a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the POSCAR file to be read.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_primitive</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Using the primitive cell instead of the cell given by the POSCAR file. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tol</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for <code>spglib</code> symmetry detection; default is 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cryst</code></td>            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded crystal structure, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.matrix_gcd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_gcd</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">max_divisor</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a greatest common divisor of rational matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular rational matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_divisor</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer. The least common multiple of all divisors in <code>m</code> should not be greater than <code>max_divisor</code>.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>d</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The greatest common divisor of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.matrix_lcm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_lcm</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a least common multiple of integer matrices <code>m1</code> and <code>m2</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code>(3, 3) array_like</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nonsingular integer matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>m</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The least common multiple of <code>m1</code> and <code>m2</code> in Hermite normal form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.niggli_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">niggli_cell</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reduce cell <code>c</code> to its Niggli cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>c</code>
            </td>
            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cell to be reduced, whose columns are cell vectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cc</code></td>            <td>
                  <code>(3, 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Niggli cell, with shortest right-handed cell vectors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>q</code></td>            <td>
                  <code>(3, 3) array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unimodular matrix satisfying <code>cc = c @ q</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.rmss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rmss</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Root-mean-square strain of given singular values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code>(..., 3) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The singular values of 3*3 matrices.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rms_strain</code></td>            <td>
                  <code>(...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root-mean-square of <code>x - 1</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.save_poscar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">cryst</span><span class="p">,</span> <span class="n">crystname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Save the crystal structure to a POSCAR file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file to save, must not already exist in current directory. If <code>filename = None</code>, a string will be returned instead.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cryst</code>
            </td>
            <td>
                  <code>cryst</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The crystal structure to be saved, consisting of the lattice vectors, species, and positions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystname</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A system description to write to the comment line of the POSCAR file. If <code>crystname = None</code>, <code>filename</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.species_poscar_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">species_poscar_format</span><span class="p">(</span><span class="n">species</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Examine whether a species array is sorted. If so, convert it to the POSCAR format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>species</code>
            </td>
            <td>
                  <code>(N,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The species array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>species_unique</code></td>            <td>
                  <code>(M,) array of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique species in the order of their first appearance in <code>species</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>species_counts</code></td>            <td>
                  <code>(M,) array of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of occurrences of each unique species in <code>species</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.unique_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_filename</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a unique filename by appending a number to the end of the given filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A message to print before the filename.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_filename</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified filename with a unique number appended.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="crystmatch.utilities.vector_reduce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_reduce</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">divisors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Minimizing the norm of <code>v</code> by adding and subtracting columns of <code>divisors</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector to be reduced.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>divisors</code>
            </td>
            <td>
                  <code>(N, ...) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vectors used to translate <code>v</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>vv</code></td>            <td>
                  <code>(N,) array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reduced <code>v</code> with minimum Euclidean norm.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 20232024 Xin-Zheng Li Group. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>